[TOC]

## Spring Cloud

### 一、系统架构的演变

#### 1. 集中式架构

当网站流量很小时，只需要一个应用，将所有的功能都部署在一起，以减少部署节点和成本。

![集中架构](img\集中式架构.png)

- 优点：
  1. 系统开发快
  2. 维护成本低
  3. 适用于并发要求较低的系统
- 缺点
  1. 代码耦合度高，后期维护困难
  2. 无法针对不同模块进行优化
  3. 无法水平扩展
  4. 单点容错率低，并发能力差

#### 2. 垂直拆分

当访问量逐渐增大，单一应用无法满足需求，此时为了应对更高的并发和业务需求，我们根据业务功能对系统进行拆分：

![垂直拆分](img\垂直拆分.png)

- 优点：
  1. 系统拆分实现了流量分担，解决了并发问题
  2. 可以针对不同模块进行优化
  3. 方便水平扩展，负载均衡，容错率提高
- 缺点：
  1. 系统间相互独立，会有很多重复开发工作，影响开发效率

#### 3. 分布式

当垂直应用越来越多，应用之间交互不可避免，将核心业务抽取出来，作为独立的服务，逐渐形成稳定的服务中心，使前端应用能更快速的响应多变的市场需求。此时，用于提高业务复用及整合的分布式调用是关键。

![分布式](img\分布式.png)

- 优点：
  1. 将基础服务进行了抽取，系统间相互调用，提高了代码复用和开发效率
- 缺点：
  1. 系统耦合度变高
  2. 调用关系错综复杂，难以维护

#### 4. 服务治理（SOA）

SOA（Service Oriented Architecture）面向服务的架构：它是一种设计方法，其中包含多个服务， 服务之间通过相互依赖最终提供一系列的功能。一个服务通常以独立的形式存在于操作系统进程中。各个服务之间通过网络调用。

![SOA](img\SOA.png)

- 优点：
  1. 简单化系统的开发，部署较为灵活
  2. 更好的适应性和扩展性
  3. 高复用性
- 缺点：
  1. 每个供应商提供的ESB产品有偏差，自身实现较为复杂；
  2. 应用服务粒度较大，ESB集成整合所有服务和协议、数据转换使得运维、测试部署困难。
  3. 所有服务都通过一个通路通信，直接降低了通信速度。

#### 5. 微服务

微服务架构是使用一套小服务来开发单个应用的方式或途径，每个服务基于单一业务能力构建，运行在自己的进程中，并使用轻量级机制通信，通常是HTTP API，并能够通过自动化部署机制来独立部署。这些服务可以使用不同的编程语言实现，以及不同数据存储技术，并保持最低限度的集中式管理。

![微服务](img\微服务.png)

> API Gateway网关是一个服务器，是系统的唯一入口。网关提供RESTful/HTTP的方式访问服务。而服务端通过服务注册中心进行服务注册和管理。

- 特点：

  - 单一职责：微服务中每一个服务都对应唯一的业务能力，做到单一职责
  - 面向服务：面向服务是说每个服务都要对外暴露服务接口API。并不关心服务的技术实现，做到与平台和语言无关，也不限定用什么技术实现，只要提供REST的接口即可。
  - 自治：自治是说服务间互相独立，互不干扰
    - 团队独立：每个服务都是一个独立的开发团队。
    - 技术独立：因为是面向服务，提供REST接口，使用什么技术没有别人干涉。
    - 前后端分离：采用前后端分离开发，提供统一REST接口，后端不用再为PC、移动段开发不同接口。
    - 数据库分离：每个服务都使用自己的数据源。

- 微服务与SOA比较：

  | 功能     | SOA                  | 微服务                         |
  | -------- | -------------------- | ------------------------------ |
  | 组件大小 | 大块业务逻辑         | 单独任务或小块业务逻辑         |
  | 耦合     | 通常松耦合           | 总是松耦合                     |
  | 管理     | 着重中央管理         | 着重分散管理                   |
  | 目标     | 确保应用能够交互操作 | 易维护、易拓展、更轻量级的交互 |

### 二、远程调用方式

#### 1. RPC

#### 2. Http

#### 3. 如何选择？

### 三、Spring Cloud简介

### 四、微服务场景模拟

### 五、Eureka注册中心

### 六、负载均衡Ribbon

###七、熔断器Hystrix

### 八、Feign

### 九、Spring Cloud GateWay网关

### 十、Spring Cloud Config分布式配置中心

### 十一、Spring Cloud Bus 服务总线





